# SettlementAgent Smart Contract Documentation

## üìò Overview

`SettlementAgent` ‚Äî —ç—Ç–æ UUPS-–∞–ø–≥—Ä–µ–π–¥–∏—Ä—É–µ–º—ã–π —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∏ –ª–∏–º–∏—Ç–∏—Ä—É–µ–º–æ–≥–æ —Å–ø–∏—Å–∞–Ω–∏—è —Å—Ä–µ–¥—Å—Ç–≤ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–æ—à–µ–ª—å–∫–æ–≤. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–æ–ª–∏, –ª–∏–º–∏—Ç—ã, –∫–æ–º–∏—Å—Å–∏–æ–Ω–Ω—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –∏ –∑–∞—â–∏—Ç—É —á–µ—Ä–µ–∑ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ.

---

## üîê Roles and Permissions

| Role               | Description |
|--------------------|-------------|
| `ADMIN_ROLE`       | –ú–æ–∂–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç, –º–µ–Ω—è—Ç—å fee-–∞–¥—Ä–µ—Å |
| `MANAGER_ROLE`     | –ò–º–µ–µ—Ç –ø—Ä–∞–≤–æ —Å–ø–∏—Å—ã–≤–∞—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–≤ |
| `FEEMANAGER_ROLE`  | –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∫–æ–º–∏—Å—Å–∏–∏ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ |

---

## üí∞ Fee System

- `feePercent` ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç –∫–æ–º–∏—Å—Å–∏–∏, –∑–∞–¥–∞—ë—Ç—Å—è –ø—Ä–∏ –¥–µ–ø–ª–æ–µ, **–Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–π**
- `customFeePercent[address]` ‚Äî –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è –∫–æ–º–∏—Å—Å–∏—è –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ (‚â§ –≥–ª–æ–±–∞–ª—å–Ω–æ–π)
- `clientFeePercent(address)` ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—É—é –∫–æ–º–∏—Å—Å–∏—é

---

## üßæ Limits

–ö–∞–∂–¥—ã–π –∫–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –∑–∞–¥–∞—Ç—å:

- `globalLimit` ‚Äî –ª–∏–º–∏—Ç –ø–æ approve (—á–µ—Ä–µ–∑ `allowLimit`)
- `limit10min` ‚Äî –ª–∏–º–∏—Ç –Ω–∞ —Å–ø–∏—Å–∞–Ω–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –º–∏–Ω—É—Ç
- `limit24h` ‚Äî –ª–∏–º–∏—Ç –Ω–∞ —Å–ø–∏—Å–∞–Ω–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞

–ö–æ–Ω—Ç—Ä–∞–∫—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç —É—Å—Ç–∞—Ä–µ–≤—à—É—é –∏—Å—Ç–æ—Ä–∏—é –∏ —É—á–∏—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.

---

## üîÑ Version Control

- –ö–∞–∂–¥–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ (`allowLimit`) —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç —Ç–µ–∫—É—â—É—é `CURRENT_VERSION`
- –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –∫–ª–∏–µ–Ω—Ç—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–∑–≤–∞—Ç—å `allowLimit()` –∑–∞–Ω–æ–≤–æ

---

## üîß Key Functions

### `allowLimit()`
–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π –ª–∏–º–∏—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–≥–æ `approve` –∏ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –≤–µ—Ä—Å–∏—é –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞.

### `setTimeLimits(uint256 limit10min, uint256 limit24h)`
–ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –ª–∏–º–∏—Ç—ã –Ω–∞ —Å–ø–∏—Å–∞–Ω–∏–µ.

### `withdrawFromClient(address client, uint256 amount, uint256 fee)`
–ú–µ–Ω–µ–¥–∂–µ—Ä —Å–ø–∏—Å—ã–≤–∞–µ—Ç —Å—Ä–µ–¥—Å—Ç–≤–∞ —Å –∫–ª–∏–µ–Ω—Ç–∞:
- –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –ª–∏–º–∏—Ç–æ–≤
- –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏
- —Å–ø–∏—Å–∞–Ω–∏–µ —Å—É–º–º—ã –∏ –∫–æ–º–∏—Å—Å–∏–∏
- –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### `setCustomFeePercent(address, uint256)`
–ù–∞–∑–Ω–∞—á–∞–µ—Ç –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—É—é –∫–æ–º–∏—Å—Å–∏—é –∫–ª–∏–µ–Ω—Ç—É.

### `removeCustomFee(address)`
–£–¥–∞–ª—è–µ—Ç –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—É—é –∫–æ–º–∏—Å—Å–∏—é (–ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≥–ª–æ–±–∞–ª—å–Ω–∞—è).

### `updateFeeAddress(address)`
–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞, –∫—É–¥–∞ –ø–µ—Ä–µ—á–∏—Å–ª—è–µ—Ç—Å—è –∫–æ–º–∏—Å—Å–∏—è. –¢–æ–ª—å–∫–æ –¥–ª—è ADMIN.

---

## üìä Public Views

- `getClientFullInfo(address)` ‚Äî –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –ª–∏–º–∏—Ç–∞–º, –∫–æ–º–∏—Å—Å–∏–∏ –∏ –∞–¥—Ä–µ—Å–∞–º
- `getWithdrawalHistory(address)` ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–ø–∏—Å–∞–Ω–∏–π –∫–ª–∏–µ–Ω—Ç–∞

---

## üö´ Restrictions

- `SettlementAddress` –∑–∞–¥–∞—ë—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –¥–µ–ø–ª–æ–µ –∏ **–Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω—ë–Ω**
- –ö–æ–º–∏—Å—Å–∏—è (`feePercent`) —Ç–∞–∫–∂–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
- –£–¥–∞–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `updateSettlementAddress`

---

## üõ° Security and Upgradeability

- –ö–æ–Ω—Ç—Ä–∞–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `UUPSUpgradeable` —á–µ—Ä–µ–∑ OpenZeppelin
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ `ADMIN_ROLE`
- –í—Å—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ª–æ–≥–∏–∫–∞ –∑–∞–≤–µ—Ä–Ω—É—Ç–∞ –≤ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∏ –ª–∏–º–∏—Ç–æ–≤

---

## üìÑ License

MIT
